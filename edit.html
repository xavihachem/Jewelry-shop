<!DOCTYPE html>
<html lang="en">
<head>
    <title>Edit Product - Admin Panel</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="512x512" href="img/logo.png">
    <link rel="icon" type="image/png" sizes="512x512" href="img/logo.png">
    <link rel="icon" type="image/png" sizes="512x512" href="img/logo.png">
    <link rel="icon" type="image/png" sizes="512x512" href="img/logo.png">
    <link rel="apple-touch-icon" sizes="512x512" href="img/logo.png">
    <meta name="msapplication-TileImage" content="img/logo.png">
    <meta name="theme-color" content="#D4AF37">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #c5a47e;
            --dark: #1a1a1a;
            --light: #f8f9fa;
            --gray: #6c757d;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .page-header {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            border-bottom: 4px solid var(--gold);
        }
        
        .page-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: white;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .card {
            border: none;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }
        
        .card-header {
            background-color: var(--dark);
            color: white;
            font-weight: 500;
            padding: 1.25rem 1.5rem;
            border-bottom: 2px solid var(--gold);
        }
        
        .card-body {
            padding: 2rem;
        }
        
        .form-label {
            font-weight: 500;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }
        
        .form-control, .form-select, .form-control:focus {
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            padding: 0.75rem 1rem;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            border-color: var(--gold);
            box-shadow: 0 0 0 0.25rem rgba(197, 164, 126, 0.25);
        }
        
        .btn-primary {
            background-color: var(--gold);
            border: none;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover, .btn-primary:focus {
            background-color: #b08f6e;
            transform: translateY(-2px);
        }
        
        .btn-outline-secondary {
            border-color: var(--gray);
            color: var(--gray);
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
        }
        
        .btn-outline-secondary:hover {
            background-color: var(--gray);
            color: white;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
        }
        
        .product-image-preview {
            width: 100%;
            max-width: 300px;
            height: auto;
            border-radius: 4px;
            margin-top: 1rem;
            border: 1px solid #e0e0e0;
            transition: all 0.3s ease;
        }
        
        .product-image-preview:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(26, 26, 26, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            -webkit-backdrop-filter: blur(4px);
            backdrop-filter: blur(4px);
        }
        
        .spinner-border {
            width: 3rem;
            height: 3rem;
            color: var(--gold);
        }
        
        .back-link {
            color: var(--gold);
            text-decoration: none;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .back-link:hover {
            color: #b08f6e;
            transform: translateX(-3px);
        }
        
        .back-link i {
            margin-right: 0.5rem;
            transition: transform 0.3s ease;
        }
        
        .back-link:hover i {
            transform: translateX(-3px);
        }
        
        .section-title {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 1.5rem;
            position: relative;
            padding-bottom: 0.75rem;
        }
        
        .section-title:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background-color: var(--gold);
        }
        
        /* Image upload styles */
        .image-upload-container {
            margin: 1rem 0;
            text-align: center;
        }
        
        .image-upload-btn {
            display: inline-block;
            padding: 0.5rem 1.5rem;
            background: var(--gold);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            margin: 0.5rem 0;
        }
        
        .image-upload-btn:hover {
            background: #b08f6e;
            transform: translateY(-2px);
        }
        
        .image-upload-preview {
            max-width: 100%;
            max-height: 300px;
            margin: 1rem auto;
            display: block;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        
        .image-upload-input {
            display: none;
        }
        
        .currency-symbol {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }
        
        .price-input-container {
            position: relative;
        }
        
        .price-input {
            padding-left: 30px !important;
        }
        
        @media (max-width: 991.98px) {
            .card-body {
                padding: 1.25rem;
            }
            
            .btn {
                padding: 0.5rem 1rem;
                font-size: 0.85rem;
            }
            
            .form-control {
                padding: 0.6rem 0.8rem;
                font-size: 0.9rem;
            }
            
            .page-title {
                font-size: 1.25rem;
            }
            
            .card-header h2 {
                font-size: 1.1rem;
            }
        }
        
        /* Additional images styles */
        #additional-images-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            gap: 12px;
            align-items: start;
        }

        .additional-image-item {
            position: relative;
            background-color: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 8px;
            transition: all 0.2s ease;
            cursor: move;
            display: flex;
            align-items: center;
            justify-content: center;
            aspect-ratio: 1 / 1; /* square */
            min-height: 110px;
        }

        .additional-image-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 4px;
        }

        .additional-image-item .remove-btn {
            position: absolute;
            top: 6px;
            right: 6px;
            padding: 2px 8px;
            line-height: 1;
        }
        
        .additional-image-item:hover {
            background-color: #f8f9fa;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .additional-image-item.dragging {
            opacity: 0.5;
            background-color: #e9ecef;
        }
        
        .additional-image-item.drag-over {
            border: 2px dashed #0d6efd;
            background-color: #f0f7ff;
        }
        
        .additional-image-item .btn-group {
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .additional-image-item:hover .btn-group {
            opacity: 1;
        }
        
        /* Additional image thumbnails */
        .additional-image-thumbnail {
            width: 60px;
            height: 60px;
            object-fit: cover;
        }
        
        /* Image upload preview */
        .image-upload-preview {
            max-width: 200px;
            height: auto;
            display: none;
            margin: 10px 0;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }
        
        /* Price input with currency */
        .price-input-container {
            position: relative;
        }
        
        .currency-symbol {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            font-weight: 500;
            color: #6c757d;
        }
        
        .price-input {
            padding-left: 40px !important;
        }
    </style>
</head>
<body>
    <!-- Page Header -->
    <header class="page-header">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <h1 class="page-title">Edit Product</h1>
                <a href="admin.html" class="back-link">
                    <i class="bi bi-arrow-left"></i> Back to Admin
                </a>
            </div>
        </div>
    </header>
    
    <div class="container">

        <div class="loading-overlay">
            <div class="text-center">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-2">Loading product data...</p>
            </div>
        </div>

        <div id="product-form-container">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h2 class="h5 mb-0">Product Details</h2>
                    <span class="badge bg-secondary">Editing Mode</span>
                </div>
                <div class="card-body">
                    <form id="edit-product-form">
                        <input type="hidden" id="product-id" name="id">
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="product-name" class="form-label">Product Name</label>
                                    <input type="text" class="form-control" id="product-name" name="name" required>
                                </div>
                                <div class="mb-3">
                                    <label for="small-description" class="form-label">Small Description (for product cards)</label>
                                    <textarea class="form-control" id="small-description" name="smallDescription" rows="2" maxlength="150" placeholder="A short description that will appear on product cards (max 150 characters)"></textarea>
                                    <div class="form-text text-muted">
                                        <span id="char-count">0</span>/150 characters
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="product-price" class="form-label">Price</label>
                                    <div class="price-input-container">
                                        <input type="number" 
                                               step="0.01" 
                                               class="form-control price-input" 
                                               id="product-price" 
                                               name="price" 
                                               required
                                               aria-label="Product price">
                                    </div>
                                </div>
                                
                                
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label for="stock-quantity" class="form-label">Stock Quantity</label>
                                        <input type="number" class="form-control" id="stock-quantity" name="stock" min="0" value="0">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Stock Status</label>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="stock-status" id="stock-available" value="متاح">
                                            <label class="form-check-label text-success" for="stock-available">
                                                متاح (Available)
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="radio" name="stock-status" id="stock-unavailable" value="غير متاح" checked>
                                            <label class="form-check-label text-danger" for="stock-unavailable">
                                                غير متاح (Out of Stock)
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="display-on-home" name="display_home">
                                    <label class="form-check-label" for="display-on-home">
                                        Display on Homepage
                                    </label>
                                </div>
                                
                                <div id="home-position-container" style="display: none;">
                                    <label for="home-position" class="form-label">Homepage Position</label>
                                    <input type="number" class="form-control" id="home-position" name="home_position" min="1" value="1">
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-4">
                                    <label class="form-label d-block">Product Image</label>
                                    <div class="image-upload-container">
                                        <img id="image-preview" 
                                             src="" 
                                             alt="Product Preview" 
                                             class="image-upload-preview mb-3">
                                        <input type="file" id="image-upload" class="image-upload-input" accept="image/*">
                                        <button type="button" class="image-upload-btn" id="upload-btn">
                                            <i class="bi bi-upload"></i> Upload New Image
                                        </button>
                                        <input type="hidden" id="product-image" name="image">
                                        <div class="text-muted small mt-2">Recommended size: 800x800px, max 3.5MB</div>
                                    </div>
                                </div>
                                
                                <div class="mb-4">
                                    <label for="product-description" class="form-label">Description</label>
                                    <textarea class="form-control" id="product-description" name="description" rows="5" required></textarea>
                                </div>
                                
                                <!-- Additional Images Section -->
                                <div class="mb-3">
                                    <label class="form-label">Additional Images</label>
                                    <div id="additional-images-container" class="mb-3">
                                        <!-- Additional images will be added here -->
                                    </div>
                                    <div class="d-flex gap-2 mb-3">
                                        <button type="button" id="add-image-btn" class="btn btn-outline-primary btn-sm" aria-label="Add additional images">
                                            <i class="bi bi-plus-lg" aria-hidden="true"></i> Add Image
                                        </button>
                                        <label for="additional-image-upload" class="visually-hidden">Upload additional images</label>
                                        <input type="file" 
                                               id="additional-image-upload" 
                                               class="d-none" 
                                               accept="image/*" 
                                               multiple 
                                               aria-describedby="additional-images-help"
                                               title="Upload additional product images">
                                    </div>
                                    <div class="text-muted small">Upload up to 5 additional images. Drag to reorder.</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex flex-column flex-sm-row justify-content-between align-items-stretch align-items-sm-center pt-4 border-top mt-4 gap-2">
                            <button type="button" id="delete-btn" class="btn btn-danger flex-grow-1 flex-sm-grow-0">
                                <i class="bi bi-trash"></i> <span class="d-none d-sm-inline">Delete</span>
                            </button>
                            <div class="d-flex gap-2 w-100 justify-content-end">
                                <a href="admin.html" class="btn btn-outline-secondary">
                                    <i class="bi bi-x-lg"></i> <span class="d-none d-sm-inline">Cancel</span>
                                </a>
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-save"></i> <span class="d-none d-sm-inline">Save</span>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Confirm Deletion</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete this product? This action cannot be undone.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" id="confirm-delete" class="btn btn-danger">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const form = document.getElementById('edit-product-form');
            const loadingOverlay = document.querySelector('.loading-overlay');
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('id');

            // State variables
            let mainImageFile = null; // Holds the new main image File object if selected
            let existingAdditionalImages = []; // Holds URLs of images already on the server
            let newAdditionalFiles = []; // Holds new additional image File objects

            if (!productId) {
                showAlert('No product ID provided. Please go back and select a product to edit.', 'danger');
                showLoading(false);
                return;
            }

            // --- Element Selectors ---
            const imagePreview = document.getElementById('image-preview');
            const imageUploadInput = document.getElementById('image-upload');
            const uploadBtn = document.getElementById('upload-btn');
            const additionalImagesContainer = document.getElementById('additional-images-container');
            const addImageBtn = document.getElementById('add-image-btn');

            // --- Utility Functions ---
            const showLoading = (show) => { loadingOverlay.style.display = show ? 'flex' : 'none'; };
            const showAlert = (message, type = 'info') => {
                const alertDiv = document.createElement('div');
                alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
                alertDiv.innerHTML = `${message}<button type="button" class="btn-close" data-bs-dismiss="alert"></button>`;
                document.querySelector('.container').insertBefore(alertDiv, document.querySelector('.container').firstChild);
                setTimeout(() => new bootstrap.Alert(alertDiv).close(), 5000);
            };

            // Image URL resolver (works for /uploads and absolute/base64)
            function getImageUrl(img) {
                if (!img || typeof img !== 'string') return '';
                const API_BASE = window.API_BASE_URL || window.location.origin;
                const trimmed = img.trim();
                if (trimmed.startsWith('data:image')) return trimmed;
                if (/^https?:\/\//i.test(trimmed)) return trimmed;
                if (trimmed.startsWith('/uploads/')) return `${API_BASE}${trimmed}`;
                if (trimmed.startsWith('uploads/')) return `${API_BASE}/${trimmed}`;
                return `${API_BASE}/uploads/${trimmed.split('/').pop()}`;
            }

            // --- Image Handling ---
            function handleMainImageSelect(file) {
                if (!file) return;
                if (!file.type.match('image.*') || file.size > 3.5 * 1024 * 1024) {
                    showAlert('Please select a valid image file under 3.5MB.', 'danger');
                    return;
                }
                mainImageFile = file;
                imagePreview.src = URL.createObjectURL(file);
            }

            uploadBtn.addEventListener('click', () => imageUploadInput.click());
            imageUploadInput.addEventListener('change', (e) => handleMainImageSelect(e.target.files[0]));

            function renderAdditionalImages() {
                additionalImagesContainer.innerHTML = '';
                const allImages = [
                    ...existingAdditionalImages.map(url => ({ type: 'existing', data: url })),
                    ...newAdditionalFiles.map(file => ({ type: 'new', data: file }))
                ];

                allImages.forEach((image, index) => {
                    const item = document.createElement('div');
                    item.className = 'additional-image-item';
                    const src = image.type === 'existing' ? getImageUrl(image.data) : URL.createObjectURL(image.data);
                    item.innerHTML = `
                        <img src="${src}" alt="Product Image">
                        <button type="button" class="btn btn-danger btn-sm remove-btn">&times;</button>
                    `;
                    item.querySelector('.remove-btn').addEventListener('click', () => {
                        if (image.type === 'existing') {
                            existingAdditionalImages = existingAdditionalImages.filter(url => url !== image.data);
                        } else {
                            newAdditionalFiles = newAdditionalFiles.filter(file => file !== image.data);
                        }
                        renderAdditionalImages();
                    });
                    additionalImagesContainer.appendChild(item);
                });
            }

            addImageBtn.addEventListener('click', () => {
                const fileInput = document.createElement('input');
                fileInput.type = 'file';
                fileInput.accept = 'image/*';
                fileInput.multiple = true;
                fileInput.onchange = (e) => {
                    for (const file of e.target.files) {
                        if (!file.type.match('image.*') || file.size > 3.5 * 1024 * 1024) {
                            showAlert(`Skipping invalid file: ${file.name}`, 'warning');
                            continue;
                        }
                        newAdditionalFiles.push(file);
                    }
                    renderAdditionalImages();
                };
                fileInput.click();
            });

            // --- Data Loading ---
            async function loadProduct() {
                showLoading(true);
                try {
                    const API_BASE = window.API_BASE_URL || window.location.origin;
                    const response = await fetch(`${API_BASE}/api/products/${productId}`, { credentials: 'include' });
                    if (!response.ok) throw new Error('Product not found.');
                    
                    const product = await response.json();

                    document.getElementById('product-id').value = product._id;
                    document.getElementById('product-name').value = product.name;
                    document.getElementById('product-price').value = product.price;
                    document.getElementById('product-description').value = product.description;
                    document.getElementById('small-description').value = product.smallDescription || '';
                    document.getElementById('stock-quantity').value = product.stock?.quantity || 0;
                    const displayOnHomeEl = document.getElementById('display-on-home');
                    const homePosEl = document.getElementById('home-position');
                    const homePosContainer = document.getElementById('home-position-container');
                    displayOnHomeEl.checked = !!product.display_home;
                    homePosEl.value = product.display_home ? (product.home_position || 1) : 1;
                    homePosContainer.style.display = product.display_home ? 'block' : 'none';
                    homePosEl.disabled = !product.display_home; // disable when hidden to avoid validation issues

                    if (product.image) {
                        imagePreview.src = getImageUrl(product.image);
                        imagePreview.style.display = 'block';
                    }

                    existingAdditionalImages = product.additionalImages || [];
                    renderAdditionalImages();

                } catch (error) {
                    showAlert(error.message, 'danger');
                } finally {
                    showLoading(false);
                }
            }

            // --- Form Submission ---
            // Toggle home position enable/disable
            document.getElementById('display-on-home').addEventListener('change', (e) => {
                const checked = e.target.checked;
                const homePosEl = document.getElementById('home-position');
                const homePosContainer = document.getElementById('home-position-container');
                homePosContainer.style.display = checked ? 'block' : 'none';
                homePosEl.disabled = !checked;
                if (checked && (!homePosEl.value || parseInt(homePosEl.value, 10) < 1)) {
                    homePosEl.value = 1;
                }
            });

            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                showLoading(true);

                try {
                    const formData = new FormData();
                    formData.append('name', document.getElementById('product-name').value);
                    formData.append('price', document.getElementById('product-price').value);
                    formData.append('description', document.getElementById('product-description').value);
                    formData.append('smallDescription', document.getElementById('small-description').value);
                    const isDisplayHome = document.getElementById('display-on-home').checked;
                    formData.append('display_home', isDisplayHome);
                    if (isDisplayHome) {
                        formData.append('home_position', document.getElementById('home-position').value || '1');
                    } else {
                        formData.append('home_position', '0');
                    }
                    
                    const stockQuantity = parseInt(document.getElementById('stock-quantity').value, 10) || 0;
                    formData.append('stock', JSON.stringify({ 
                        quantity: stockQuantity,
                        status: stockQuantity > 0 ? 'متاح' : 'غير متاح'
                    }));

                    // Append new main image if one was selected
                    if (mainImageFile) {
                        formData.append('image', mainImageFile);
                    }

                    // Append the list of REMAINING existing image URLs as a JSON string
                    formData.append('additionalImages', JSON.stringify(existingAdditionalImages));

                    // Append NEW additional image files
                    newAdditionalFiles.forEach(file => {
                        formData.append('additionalImages', file);
                    });

                    const API_BASE = window.API_BASE_URL || window.location.origin;
                    const response = await fetch(`${API_BASE}/api/products/${productId}`, {
                        method: 'PUT',
                        credentials: 'include',
                        body: formData
                    });

                    const result = await response.json();
                    if (!response.ok) {
                        throw new Error(result.message || 'Failed to update product.');
                    }

                    showAlert('Product updated successfully!', 'success');
                    setTimeout(() => window.location.href = 'admin.html', 1500);

                } catch (error) {
                    showAlert(error.message, 'danger');
                } finally {
                    showLoading(false);
                }
            });

            // Initial Load
            loadProduct();
        });
    </script>

    <!-- Facebook Pixel NoScript -->
    <!--#include virtual="/includes/facebook-pixel-noscript.html" -->
    <!-- End Facebook Pixel NoScript -->
</body>
</html>
